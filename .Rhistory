# Chunk 1
# knitr options
knitr::opts_chunk$set(echo = TRUE)
# load libraries
library(tidyverse)
library(data.table)
library(lubridate) # lubridate used to convert char to datetime
dt <- fread("../../HW1/intro_dataset.csv") # load dataset
# Chunk 3
dt %>%
mutate(p1prom = as.factor(p1prom)) %>%
ggplot() +
geom_bar(mapping=aes(x=country, fill=p1prom), position='dodge')
# Chunk 4
dt %>%
mutate(p1prom = as.factor(p1prom)) %>%
ggplot() +
geom_bar(mapping=aes(x=country, fill=p1prom), position='dodge') +
scale_fill_manual(values=c("yellow", "green"))
# Chunk 5
ggplot(data = dt, mapping = aes(x = storeNum, y = p1sales)) +
geom_violin() + theme_bw()
# Chunk 6
# draw median on geom_violin
# first option using geom_boxplot
ggplot(data = dt, mapping = aes(x = storeNum, y = p1sales)) +
geom_violin(draw_quantiles = c(0.25, 0.5, 0.75)) +
theme_bw()
# second option using stat_summary
ggplot(data = dt, mapping = aes(x = storeNum, y = p1sales)) +
geom_violin() +
stat_summary(fun.y = median, geom = "point", size=2, color="red") +
theme_bw()
# Chunk 7
dt %>%
group_by(country) %>%
summarise(p1sales=sum(p1sales)) %>%
ggplot(aes(x=country, y=p1sales, group=1)) + geom_line() + theme_bw()
# Chunk 8
dt %>%
filter(storeNum=='102' & Year==2) %>%
mutate(Week = str_pad(Week, width=2, side='left', pad='0')) %>%
mutate(Time = paste(Year, Week, sep='-')) %>%
ggplot() + geom_line(aes(x=Time, y=p2sales, group=1), color='grey60') +
theme(axis.text.x = element_text(angle = 70, hjust = 1)) +
geom_smooth(aes(x=Time, y=p2sales, group=1), color='red')
# Chunk 9
# product 1 & product 2 sales
ggplot(dt) +
geom_point(aes(x=p1sales, y=p2sales)) +
labs(x="Product 1 Sales", y="Product 2 Sales")
# Chunk 10
cor(dt$p1sales, dt$p2sales) # p1sales & p2sales correlation coefficient
# Chunk 11
dt %>%
group_by(storeNum) %>%
summarise(total_sales = sum(p1sales) + sum(p2sales)) %>%
arrange(desc(total_sales)) %>%
top_n(5) %>%
ggplot(aes(x=reorder(storeNum, -total_sales), y=total_sales)) +
geom_bar(stat = "identity", fill = "#91A6FF") +
labs(x = "Store #", y = "Total Sales")
# Chunk 12
dt %>%
filter(country == "US" & Week %in% c(1:12)) %>%
ggplot(aes(x = factor(Week))) +
geom_boxplot(aes(y=p1sales)) +
labs(title="Sales dynamic of Product 1 in first quarter across US",
x="Week", y="Product 1 Sales")
# Chunk 13
ggplot(dt) +
geom_point(aes(x=p1sales, y=p2sales, color=factor(country)))
# Chunk 14
accounts <- fread("../../HW1/bank_accounts.csv")
# Chunk 15
str(accounts)
# Chunk 16
accounts$time <- as.Date(accounts$time)
str(accounts) # check if time is Date now
# Chunk 17
summary(accounts)
# Chunk 18
acc <- accounts %>%
gather(account_a, account_b, account_c, key = "account", value="amount") # gather data
# rename accounts for easier reading
acc$account[acc$account =="account_a"] <- "a"
acc$account[acc$account =="account_b"] <- "b"
acc$account[acc$account =="account_c"] <- "c"
unique(acc$account) # check if values changed
# Chunk 19
df <- acc %>%
mutate(year = as.integer(format(time, format = "%Y")),
month = as.integer(format(time, format = "%m")),
day = as.integer(format(time, format = "%d"))) %>%
select(time, year, month, day, account, amount)
# Chunk 20
ggplot(df, aes(x=time, y=amount)) +
geom_line(aes(color=account)) +
scale_color_discrete(name="Account", labels=c("a", "b", "c"))
# Chunk 21
# check customer a's 5 last transactions
df %>%
filter(account=="a") %>%
arrange(time) %>%
select(time, account, amount) %>%
tail(5)
# Chunk 22
df %>%
filter(month == 1, day == 1) %>%
group_by(year) %>%
summarise(total = sum(amount)) %>%
ggplot(aes(x=factor(year), y=total)) +
geom_bar(stat = "identity", fill="#3E7CB1") +
theme_minimal() +
labs(x="Year", y="Total")
# Chunk 23
df %>%
filter(account == "c") %>%
select(month, account, amount) %>%
group_by(month) %>%
ggplot(aes(x=factor(month), y=amount)) +
geom_boxplot() +
labs(x="Months", y="Amount")
dt <- fread("../../HW1/intro_dataset.csv") # load dataset
dt
dt[,4]
